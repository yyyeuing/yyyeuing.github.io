<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Attention-æ·±åº¦å­¦ä¹ ä¸­çš„æ³¨æ„åŠ›æœºåˆ¶]]></title>
    <url>%2Fyyyeuing.github.io%2F2019%2F08%2F13%2Fmachine-learning%2F</url>
    <content type="text"><![CDATA[æ³¨æ„åŠ›æ¨¡åž‹ï¼ˆAttention Modelï¼‰è¿‘å¹´æ¥è¢«å¹¿æ³›çš„åº”ç”¨åˆ°NLPï¼Œå›¾åƒè¯†åˆ«ï¼Œè¯­éŸ³è¯†åˆ«ç­‰ä¸åŒç¨‹åº¦çš„æ·±åº¦å­¦ä¹ ä¸­ã€‚ Encoder-Decoderæ¡†æž¶å¯¹äºŽå¥å­&lt;Source,Target&gt;,æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ç»™å®šè¾“å…¥å¥å­Source,æœŸå¾…é€šè¿‡Encoder-Decoderæ¡†æž¶æ¥ç”Ÿæˆç›®æ ‡å¥å­Target.Sourceå’ŒTargetå¯ä»¥æ˜¯åŒä¸€ç§è¯­è¨€ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸åŒçš„è¯­è¨€ã€‚Sourceå’ŒTargetåˆ†åˆ«ç”±å„è‡ªçš„å•è¯åºåˆ—æž„æˆã€‚ Encoderå°±æ˜¯å¯¹è¾“å…¥çš„å¥å­è¿›è¡Œç¼–ç ï¼Œå°†è¾“å…¥å¥å­é€šè¿‡éžçº¿æ€§å˜æ¢è½¬æ¢ä¸ºä¸­é—´è¯­ä¹‰è¡¨ç¤ºCã€‚ Decoderå°±æ˜¯æ ¹æ®å¥å­çš„ä¸­é—´è¯­ä¹‰è¡¨ç¤ºCå’Œä¹‹å‰å·²ç»ç”Ÿæˆçš„åŽ†å²ä¿¡æ¯y1,y2â€¦â€¦yiæ¥ç”Ÿæˆiæ—¶åˆ»è¦ç”Ÿæˆçš„å•è¯yi;ç¼ºç‚¹ï¼šåœ¨ç”Ÿæˆç›®æ ‡å¥å­çš„å•è¯æ˜¯ï¼Œä¸è®ºç”Ÿæˆå“ªä¸ªå•è¯ï¼Œå®ƒä»¬ä½¿ç”¨çš„è¾“å…¥å¥å­Sourceçš„è¯­ä¹‰ç¼–ç Céƒ½æ˜¯ä¸€æ ·çš„ã€‚è¿™è¯´æ˜ŽSourceä¸­ä»»æ„å•è¯å¯¹ç”ŸæˆæŸä¸ªç›®æ ‡å•è¯yiæ¥è¯´å½±å“åŠ›éƒ½æ˜¯ç›¸åŒçš„ã€‚ç›¸å½“äºŽäººçœ¼çœ‹åˆ°ç”»é¢çœ¼ä¸­å´æ²¡æœ‰ç„¦ç‚¹ã€‚ä¸¾ä¸ªæ —å­ï¼šå¦‚æžœå°†â€œæˆ‘çˆ±ä¸­å›½â€è¿™å››ä¸ªå­—ç¿»è¯‘æˆè‹±æ–‡ï¼Œå³â€œI love Chinaâ€ã€‚ç”¨Encoder-Decoderæ¡†æž¶é€æ­¥ç”Ÿæˆè‹±æ–‡å•è¯ï¼šâ€œIâ€,â€œloveâ€ï¼Œâ€œChinaâ€ã€‚åœ¨ç¿»è¯‘â€œChinaâ€è¿™ä¸ªè‹±æ–‡å•è¯çš„æ—¶å€™ï¼Œåˆ†å¿ƒæ¨¡åž‹ï¼ˆEncoder-Decoderï¼‰é‡Œé¢æ¯ä¸ªä¸­æ–‡å•è¯å¯¹äºŽç¿»è¯‘ç›®æ ‡å•è¯â€œChinaâ€è´¡çŒ®ç›¸åŒã€‚ Attentionæ¨¡åž‹Soft Attentionæ¨¡åž‹é’ˆå¯¹ä¸Šè¿°æ —å­ï¼Œå¦‚æžœå¼•å…¥Attentionæ¨¡åž‹çš„è¯ï¼Œåœ¨ç¿»è¯‘â€œChinaâ€çš„æ—¶å€™ï¼Œä¼šä½“çŽ°ä¸­æ–‡å•è¯å¯¹äºŽç¿»è¯‘å½“å‰è‹±æ–‡å•è¯ä¸åŒçš„å½±å“ç¨‹åº¦ï¼Œç±»ä¼¼äºŽç»™å‡ºä¸€ä¸ªæ¦‚çŽ‡åˆ†å¸ƒå€¼ï¼šï¼ˆæˆ‘ï¼š0.3ï¼‰ï¼ˆçˆ±ï¼š0.2ï¼‰ï¼ˆä¸­å›½ï¼š0.5ï¼‰æ¯ä¸ªä¸­æ–‡è¯ç»„çš„æ¦‚çŽ‡ä»£è¡¨äº†ç¿»è¯‘å½“å‰å•è¯â€œChinaâ€æ—¶ï¼Œæ³¨æ„åŠ›åˆ†é…æ¨¡åž‹åˆ†é…ç»™ä¸åŒè‹±æ–‡å•è¯çš„æ³¨æ„åŠ›å¤§å°ã€‚Attentionæ¨¡åž‹çš„å…³é”®åœ¨äºŽï¼šç”±å›ºå®šçš„ä¸­é—´è¯­ä¹‰è¡¨ç¤ºCæ¢æˆäº†æ ¹æ®å½“å‰è¾“å‡ºå•è¯æ¥è°ƒæ•´æˆåŠ å…¥æ³¨æ„åŠ›æ¨¡åž‹çš„å˜åŒ–çš„Ciã€‚ç”Ÿæˆç›®æ ‡å¥å­å•è¯çš„è¿‡ç¨‹å˜æˆä¸‹é¢å½¢å¼ï¼šé‚£ä¹ˆç”Ÿæˆç›®æ ‡å¥å­æŸä¸ªå•è¯ï¼Œæ¯”å¦‚â€œChinaâ€çš„æ—¶å€™ï¼Œå¦‚ä½•çŸ¥é“Attentionæ¨¡åž‹æ‰€éœ€è¦çš„è¾“å…¥å¥å­å•è¯æ³¨æ„åŠ›åˆ†é…æ¦‚çŽ‡åˆ†å¸ƒå€¼å‘¢ï¼Ÿï¼Ÿï¼Ÿä¸ºäº†æ–¹ä¾¿è§£é‡Šï¼Œæˆ‘ä»¬å†æ¬¡å°†ä¸Šè¿°çš„åˆ†å¿ƒæ¨¡åž‹æ‹¿æ¥ï¼Œä¸è¿‡è¿™æ¬¡æˆ‘ä»¬ç”¨RNNæ¨¡åž‹æ¥ä»£æ›¿å®ƒçš„Encoderå’ŒDecoderã€‚é‚£ä¹ˆä¸‹å›¾ðŸ‘‡å°±å¯ä»¥è§£é‡Šäº†Attentionæœºåˆ¶çš„æœ¬è´¨æ€æƒ³æˆ‘ä»¬å°†Attentionæœºåˆ¶ä»Žä¸Šé¢çš„Encoder-Decoderæ¡†æž¶ä¸­å‰¥ç¦»ã€‚å°†Sourceä¸­çš„æž„æˆå…ƒç´ æƒ³è±¡æˆæ˜¯ç”±ä¸€ç³»åˆ—&lt;Key,Value&gt;æ•°æ®å¯¹æž„æˆï¼Œæ­¤æ—¶ç»™å®šTargetä¸­çš„æŸä¸ªå…ƒç´ Queryï¼Œé€šè¿‡è®¡ç®—Queryå’Œå„ä¸ªKeyçš„ç›¸ä¼¼æ€§æˆ–è€…ç›¸å…³æ€§ï¼Œå¾—åˆ°æ¯ä¸ªKeyå¯¹åº”Valueçš„æƒé‡ç³»æ•°ï¼Œç„¶åŽå¯¹Valueè¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œå³å¾—åˆ°äº†æœ€ç»ˆçš„Attentionæ•°å€¼ã€‚æ‰€ä»¥æœ¬è´¨ä¸ŠAttentionæœºåˆ¶æ˜¯å¯¹Sourceä¸­å…ƒç´ çš„Valueå€¼è¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œè€ŒQueryå’Œkeyç”¨æ¥è®¡ç®—å¯¹åº”Valueçš„æƒé‡ç³»æ•°ã€‚å¯è¡¨è¾¾ä¸ºä»¥ä¸‹å…¬å¼ðŸ‘‡Attentionæœºåˆ¶çš„å…·ä½“è®¡ç®—è¿‡ç¨‹ é˜¶æ®µä¸€ï¼šæ ¹æ®Queryå’ŒKeyè®¡ç®—ä¸¤è€…çš„ç›¸ä¼¼æ€§æˆ–è€…ç›¸å…³æ€§ï¼› é˜¶æ®µäºŒï¼šå¯¹ç¬¬ä¸€é˜¶æ®µçš„åŽŸå§‹åˆ†å€¼è¿›è¡Œå½’ä¸€åŒ–å¤„ç† é˜¶æ®µä¸‰ï¼šæ ¹æ®æƒé‡ç³»æ•°å¯¹Valueè¿›è¡ŒåŠ æƒæ±‚å’Œå…·ä½“è¡¨çŽ°å‚è€ƒä¸‹å›¾å…¶ä¸­ï¼Œç¬¬ä¸€é˜¶æ®µå¸¸è§çš„æ–¹æ³•æœ‰ä¸‰ç§ï¼šæ±‚ä¸¤è€…é—´çš„å‘é‡ç‚¹ç§¯ï¼Œæ±‚ä¸¤è€…çš„å‘é‡Cosineç›¸ä¼¼æ€§æˆ–è€…é€šè¿‡å†å¼•å…¥é¢å¤–çš„ç¥žç»ç½‘ç»œæ¥æ±‚å€¼ã€‚ç¬¬äºŒé˜¶æ®µå¼•å…¥SoftMaxã€‚ä¸€æ–¹é¢å¯è¿›è¡Œå½’ä¸€åŒ–ï¼Œå°†åŽŸå§‹è®¡ç®—åˆ†å€¼æ•´ç†æˆæ‰€æœ‰å…ƒç´ æƒé‡ä¹‹å’Œä¸º1çš„æ¦‚çŽ‡åˆ†å¸ƒï¼›å¦ä¸€æ–¹é¢ä¹Ÿå¯ä»¥é€šè¿‡SoftMaxçš„å†…åœ¨æœºåˆ¶æ›´åŠ çªå‡ºé‡è¦å…ƒç´ çš„æƒé‡ã€‚ç¬¬äºŒé˜¶æ®µè®¡ç®—ç»“æžœaiå°±æ˜¯Valueå¯¹åº”çš„æƒé‡ç³»æ•°ï¼Œç„¶åŽè¿›è¡ŒåŠ æƒæ±‚å’Œå°±å¯ä»¥å¾—åˆ°Attentionçš„æ•°å€¼ã€‚ Multi-Head AttentionGoogleæå‡ºçš„æ–°æ¦‚å¿µï¼Œæ˜¯Attentionæœºåˆ¶çš„å®Œå–„ã€‚é€šè¿‡æŠŠQuery,Key,Valueé€šè¿‡å‚æ•°çŸ©é˜µæ˜ å°„ä¸€ä¸‹ï¼Œç„¶åŽå†åšAttentionï¼ŒæŠŠè¿™ä¸ªè¿‡ç¨‹é‡å¤åšhæ¬¡ï¼Œæœ€åŽå°†ç»“æžœæ‹¼æŽ¥èµ·æ¥ã€‚ Self Attentionæ¨¡åž‹Attentionæœºåˆ¶å‘ç”Ÿåœ¨Targetçš„å…ƒç´ Queryå’ŒSourceä¸­æ‰€æœ‰å…ƒç´ ä¹‹é—´ã€‚è€ŒSelf AttentionæŒ‡çš„æ˜¯Sourceå†…éƒ¨å…ƒç´ ä¹‹é—´æˆ–è€…Targetå†…éƒ¨å…ƒç´ ä¹‹é—´å‘ç”Ÿçš„Attentionæœºåˆ¶ï¼Œå¯ä»¥ç†è§£ä¸ºTarget=Sourceè¿™ç§ç‰¹æ®Šæƒ…å†µä¸‹çš„æ³¨æ„åŠ›æœºåˆ¶ã€‚Self Attentionå¯ä»¥æ•èŽ·åŒä¸€ä¸ªå¥å­ä¸­å•è¯ä¹‹é—´çš„ä¸€äº›å¥æ³•ç‰¹å¾æˆ–è€…è¯­ä¹‰ç‰¹å¾ï¼Œä¼šæ›´å®¹æ˜“æ•èŽ·å¥å­ä¸­é•¿è·ç¦»çš„ç›¸äº’ä¾èµ–çš„ç‰¹å¾ã€‚]]></content>
      <categories>
        <category>æœºå™¨å­¦ä¹ </category>
      </categories>
  </entry>
</search>
